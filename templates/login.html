<!DOCTYPE html>
<html lang="en" data-bs-theme="dark">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Gambit Admin - Sign In</title>
    <link rel="stylesheet" href="https://cdn.replit.com/agent/bootstrap-agent-dark-theme.min.css">
    <style>
        body {
            height: 100vh;
            background-color: var(--bs-dark);
            overflow: hidden;
        }
        .login-container {
            height: 100%;
        }
        .gradient-bg {
            background: linear-gradient(135deg, #8a2be2 0%, #4169e1 50%, #00bfff 100%);
            position: relative;
        }
        .logo {
            position: absolute;
            top: 40px;
            left: 40px;
            width: 50px;
            height: 50px;
        }
        .welcome-text {
            position: absolute;
            bottom: 120px;
            left: 40px;
            color: white;
        }
        .form-control {
            background-color: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(255, 255, 255, 0.1);
            color: white;
            padding: 12px 15px;
        }
        .form-control:focus {
            background-color: rgba(255, 255, 255, 0.08);
            border-color: rgba(255, 255, 255, 0.2);
            box-shadow: 0 0 0 0.25rem rgba(255, 255, 255, 0.1);
            color: white;
        }
        .btn-primary {
            background: linear-gradient(90deg, #8a2be2 0%, #4169e1 100%);
            border: none;
            padding: 12px;
            font-weight: 500;
        }
        .password-field {
            position: relative;
        }
        .password-toggle {
            position: absolute;
            right: 15px;
            top: 50%;
            transform: translateY(-50%);
            background: none;
            border: none;
            color: rgba(255, 255, 255, 0.5);
            cursor: pointer;
        }
        .forgot-password {
            text-align: right;
            font-size: 14px;
        }
        .forgot-password a {
            color: #00b4db;
            text-decoration: none;
        }
        .alert {
            border-radius: 4px;
            padding: 12px;
            margin-bottom: 20px;
        }
    </style>
</head>
<body>
    <div class="container-fluid p-0 login-container">
        <div class="row g-0 h-100">
            <!-- Left side with gradient background -->
            <div class="col-md-6 gradient-bg">
                <div class="logo">
                    <svg width="40" height="40" viewBox="0 0 40 40" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <path d="M30.9772 17.6775C31.6735 21.1868 30.4772 26.2505 25.3587 28.9414C20.9864 31.2026 15.4698 30.7196 11.7526 27.4539C8.03539 24.1882 6.9511 19.009 8.78202 14.3812C8.91008 14.0841 9.05579 13.7947 9.21764 13.5147C11.4212 9.32982 16.1068 6.98254 20.8711 7.92876C24.2159 8.61388 26.9797 10.74 28.5058 13.6112" stroke="white" stroke-width="2" stroke-linecap="round"/>
                        <path d="M28.5057 13.6113L21.7909 20.2525C21.3356 20.7043 20.5934 20.7016 20.1416 20.2462L19.4419 19.5401C18.9901 19.0847 18.9928 18.3425 19.4482 17.8907L25.0084 12.3685" stroke="white" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                    </svg>
                </div>
                <div class="welcome-text">
                    <h2>Your Go-To Hub For Real-Time Sports Insights.</h2>
                    <p class="mt-3">Stay ahead of the game with in-depth statistics, live updates,<br>and powerful insights into every moment of your favorite sports.</p>
                </div>
            </div>
            
            <!-- Right side with login form -->
            <div class="col-md-6 d-flex align-items-center justify-content-center">
                <div class="login-form-container p-4" style="width: 80%;">
                    <h2 class="mb-2">Sign In</h2>
                    <p class="text-muted mb-4">Welcome to Gambit</p>
                    
                    <!-- Error message container - hidden by default -->
                    <div id="error-alert" class="alert alert-danger d-none" role="alert">
                        Invalid email or password. Please try again.
                    </div>
                    
                    <form id="login-form" method="post">
                        <div class="mb-3">
                            <label for="email" class="form-label">Username or Email <span class="text-danger">*</span></label>
                            <input type="text" class="form-control" id="email" name="email" placeholder="Enter your username or email address" required>
                        </div>
                        
                        <div class="mb-2">
                            <label for="password" class="form-label">Password <span class="text-danger">*</span></label>
                            <div class="password-field">
                                <input type="password" class="form-control" id="password" name="password" placeholder="Enter your password" required>
                                <button type="button" class="password-toggle" id="toggle-password">
                                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-eye" viewBox="0 0 16 16">
                                        <path d="M16 8s-3-5.5-8-5.5S0 8 0 8s3 5.5 8 5.5S16 8 16 8zM1.173 8a13.133 13.133 0 0 1 1.66-2.043C4.12 4.668 5.88 3.5 8 3.5c2.12 0 3.879 1.168 5.168 2.457A13.133 13.133 0 0 1 14.828 8c-.058.087-.122.183-.195.288-.335.48-.83 1.12-1.465 1.755C11.879 11.332 10.119 12.5 8 12.5c-2.12 0-3.879-1.168-5.168-2.457A13.134 13.134 0 0 1 1.172 8z"/>
                                        <path d="M8 5.5a2.5 2.5 0 1 0 0 5 2.5 2.5 0 0 0 0-5zM4.5 8a3.5 3.5 0 1 1 7 0 3.5 3.5 0 0 1-7 0z"/>
                                    </svg>
                                </button>
                            </div>
                        </div>
                        
                        <div class="mb-4 forgot-password">
                            <a href="#" id="forgot-password-link">Forgot Password?</a>
                        </div>
                        
                        <button type="submit" class="btn btn-primary w-100">Sign In</button>
                    </form>
                </div>
            </div>
        </div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // Password toggle visibility
            const togglePassword = document.getElementById('toggle-password');
            const passwordField = document.getElementById('password');
            
            togglePassword.addEventListener('click', function() {
                const type = passwordField.getAttribute('type') === 'password' ? 'text' : 'password';
                passwordField.setAttribute('type', type);
                
                // Toggle icon
                if (type === 'text') {
                    togglePassword.innerHTML = `
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-eye-slash" viewBox="0 0 16 16">
                            <path d="M13.359 11.238C15.06 9.72 16 8 16 8s-3-5.5-8-5.5a7.028 7.028 0 0 0-2.79.588l.77.771A5.944 5.944 0 0 1 8 3.5c2.12 0 3.879 1.168 5.168 2.457A13.134 13.134 0 0 1 14.828 8c-.058.087-.122.183-.195.288-.335.48-.83 1.12-1.465 1.755-.165.165-.337.328-.517.486l.708.709z"/>
                            <path d="M11.297 9.176a3.5 3.5 0 0 0-4.474-4.474l.823.823a2.5 2.5 0 0 1 2.829 2.829l.822.822zm-2.943 1.299.822.822a3.5 3.5 0 0 1-4.474-4.474l.823.823a2.5 2.5 0 0 0 2.829 2.829z"/>
                            <path d="M3.35 5.47c-.18.16-.353.322-.518.487A13.134 13.134 0 0 0 1.172 8l.195.288c.335.48.83 1.12 1.465 1.755C4.121 11.332 5.881 12.5 8 12.5c.716 0 1.39-.133 2.02-.36l.77.772A7.029 7.029 0 0 1 8 13.5C3 13.5 0 8 0 8s.939-1.721 2.641-3.238l.708.709zm10.296 8.884-12-12 .708-.708 12 12-.708.708z"/>
                        </svg>
                    `;
                } else {
                    togglePassword.innerHTML = `
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-eye" viewBox="0 0 16 16">
                            <path d="M16 8s-3-5.5-8-5.5S0 8 0 8s3 5.5 8 5.5S16 8 16 8zM1.173 8a13.133 13.133 0 0 1 1.66-2.043C4.12 4.668 5.88 3.5 8 3.5c2.12 0 3.879 1.168 5.168 2.457A13.133 13.133 0 0 1 14.828 8c-.058.087-.122.183-.195.288-.335.48-.83 1.12-1.465 1.755C11.879 11.332 10.119 12.5 8 12.5c-2.12 0-3.879-1.168-5.168-2.457A13.134 13.134 0 0 1 1.172 8z"/>
                            <path d="M8 5.5a2.5 2.5 0 1 0 0 5 2.5 2.5 0 0 0 0-5zM4.5 8a3.5 3.5 0 1 1 7 0 3.5 3.5 0 0 1-7 0z"/>
                        </svg>
                    `;
                }
            });
            
            // Handle form submission
            const loginForm = document.getElementById('login-form');
            const errorAlert = document.getElementById('error-alert');
            
            loginForm.addEventListener('submit', function(e) {
                e.preventDefault();
                const email = document.getElementById('email').value;
                const password = document.getElementById('password').value;
                
                // Call the API
                fetch('/api/auth/login', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({
                        username: email,  // Our backend expects 'username' instead of 'email'
                        password: password
                    })
                })
                .then(response => {
                    console.log('Response status:', response.status);
                    console.log('Response headers:', response.headers);
                    return response.json();
                })
                .then(data => {
                    console.log('Login response:', data);
                    
                    if (data.success === true) {
                        // Store token in localStorage
                        localStorage.setItem('authToken', data.data.token);
                        localStorage.setItem('adminData', JSON.stringify(data.data.admin));
                        
                        // Also store the token in a cookie for more persistent authentication
                        // This will make it available for regular page navigation
                        document.cookie = `auth_token=${data.data.token}; path=/; max-age=${60*60*24*7}`; // 7 days expiry
                        
                        // Log success information
                        console.log('Auth token stored in localStorage and cookie');
                        console.log('Admin data stored:', data.data.admin);
                        
                        // Add a small delay to ensure localStorage is updated
                        setTimeout(() => {
                            // Redirect to dashboard
                            window.location.href = '/';
                        }, 300);
                    } else {
                        // Show error message
                        console.error('Login failed:', data);
                        errorAlert.textContent = data.message || 'Login failed. Please check your credentials.';
                        errorAlert.classList.remove('d-none');
                    }
                })
                .catch(error => {
                    console.error('Error:', error);
                    errorAlert.textContent = 'An error occurred. Please try again later.';
                    errorAlert.classList.remove('d-none');
                });
            });
            
            // Forgot password link
            const forgotPasswordLink = document.getElementById('forgot-password-link');
            forgotPasswordLink.addEventListener('click', function(e) {
                e.preventDefault();
                // You can implement password recovery functionality here
                alert('Password recovery feature will be implemented soon.');
            });
        });
    </script>
</body>
</html>